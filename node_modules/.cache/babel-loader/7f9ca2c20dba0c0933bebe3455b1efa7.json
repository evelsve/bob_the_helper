{"ast":null,"code":"import _objectSpread from \"/Users/evelsve/repos/mood-admin/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport { send, assign } from \"xstate\";\nimport { promptAndAsk, nluRequest } from \"./index\";\nconst grammar = {\n  \"of course\": {\n    approval: true\n  },\n  \"yes\": {\n    approval: true\n  },\n  \"yeah\": {\n    approval: true\n  },\n  \"yup\": {\n    approval: true\n  },\n  \"sure\": {\n    approval: true\n  },\n  \"no\": {\n    approval: false\n  },\n  \"nah\": {\n    approval: false\n  },\n  \"nope\": {\n    approval: false\n  }\n};\nexport const dmMachine1 = {\n  initial: 'idle',\n  states: {\n    // ...\n    idle: {},\n    // ...\n    start_pos: {\n      initial: \"quest\",\n      states: {\n        quest: _objectSpread({\n          on: {\n            RECOGNISED: {\n              target: \"query\",\n              actions: assign(context => {\n                return {\n                  option: context.recResult\n                };\n              })\n            }\n          }\n        }, promptAndAsk(\"Would you like to do a chore\"))\n      } // ...misUnderstood(`Would you like to do a chore?`,  [\"#root.dm1.idle\", \"#root.initial_welcome.help\"])\n\n    },\n    // ...\n    query: {\n      invoke: {\n        id: 'rasa',\n        src: (context, event) => nluRequest(context.option),\n        onDone: {\n          actions: [assign((context, event) => {\n            return {\n              option: event.data.intent.name\n            };\n          }), (context, event) => console.log(event.data)],\n          target: \"distributor\"\n        },\n        onError: {\n          target: '#root.dm1.start_pos.quest.help',\n          actions: (context, event) => console.log(event.data)\n        }\n      }\n    },\n    // ...\n    distributor: {\n      initial: \"prompt\",\n      on: {\n        ENDSPEECH: [{\n          cond: context => context.option === 'agreement',\n          target: \"ideas\"\n        }, {\n          cond: context => context.option === 'disagreement',\n          target: \"to_do\"\n        }, {\n          target: \"others\"\n        }]\n      },\n      states: {\n        prompt: {\n          entry: send(context => ({\n            type: \"SPEAK\",\n            value: \"Understood.\"\n          }))\n        }\n      }\n    },\n    // ...\n    others: {\n      initial: \"prompt\",\n      // on: {\n      //     ENDSPEECH: [\n      //         {cond: (context) => context.option === 'create_ideas', target: \"ideas\"},\n      //         {cond: (context) => context.option === 'create_todo', target: \"to_do\"},\n      //         { target: \"others\" }]\n      //     },\n      states: {\n        prompt: {\n          entry: send({\n            type: \"SPEAK\",\n            value: \"I suppose you said something strange\"\n          }),\n          on: {\n            ENDSPEECH: '#root.dm1.start_pos.quest.help'\n          }\n        }\n      }\n    },\n    // ...\n    to_do: {},\n    // ...\n    ideas: {}\n  }\n};","map":{"version":3,"sources":["/Users/evelsve/repos/mood-admin/src/dmPositive.ts"],"names":["send","assign","promptAndAsk","nluRequest","grammar","approval","dmMachine1","initial","states","idle","start_pos","quest","on","RECOGNISED","target","actions","context","option","recResult","query","invoke","id","src","event","onDone","data","intent","name","console","log","onError","distributor","ENDSPEECH","cond","prompt","entry","type","value","others","to_do","ideas"],"mappings":"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","sourcesContent":["import { MachineConfig, send, assign } from \"xstate\";\nimport {say, listen, promptAndAsk, nluRequest, misUnderstood } from \"./index\";\nimport { list } from \"./todo_list\"\n\n\nconst grammar: { [index: string]: {\n    approval?:  boolean,\n}} = {\n\"of course\": { approval: true },\n\"yes\": { approval: true },\n\"yeah\": { approval: true },\n\"yup\": { approval: true },\n\"sure\": { approval: true },\n\"no\": { approval: false },\n\"nah\": { approval: false },\n\"nope\": { approval: false }}\n\n\n\n\nexport const dmMachine1: MachineConfig<SDSContext, any, SDSEvent> = ({\n    initial: 'idle',\n    states: {\n        // ...\n        idle: {},\n        // ...\n        start_pos: {\n            initial: \"quest\",\n            states: {\n                quest: {\n                        on: {\n                            RECOGNISED: {\n                                target: \"query\",\n                                actions: assign((context) => { return { option: context.recResult } }),\n                            }},\n                        ...promptAndAsk(\"Would you like to do a chore\")\n                    },\n                },\n            // ...misUnderstood(`Would you like to do a chore?`,  [\"#root.dm1.idle\", \"#root.initial_welcome.help\"])\n            },\n            // ...\n            query: {\n                invoke: {\n                    id: 'rasa',\n                    src: (context, event) => nluRequest(context.option),\n                    onDone: {\n                        actions: [assign((context, event) => { return  {option: event.data.intent.name} }), \n                        (context: SDSContext, event: any) => console.log(event.data)],\n                        target: \"distributor\"\n                    },\n                    onError: {\n                        target: '#root.dm1.start_pos.quest.help',\n                        actions: (context, event) => console.log(event.data)}\n                }\n            },\n            // ...\n            distributor: {\n                initial: \"prompt\",\n                on: {\n                    ENDSPEECH: [\n                        {cond: (context) => context.option === 'agreement', target: \"ideas\"},\n                    \n                        {cond: (context) => context.option === 'disagreement', target: \"to_do\"},\n                        \n                        { target: \"others\" }]\n                        \n                    },\n                states: {\n                    prompt: {\n                        entry: send((context) => ({type: \"SPEAK\", value: `Understood.`})),\n                    }\n                }\n            },\n            // ...\n            others: {\n                initial: \"prompt\",\n                // on: {\n                //     ENDSPEECH: [\n                //         {cond: (context) => context.option === 'create_ideas', target: \"ideas\"},\n                //         {cond: (context) => context.option === 'create_todo', target: \"to_do\"},\n                //         { target: \"others\" }]\n                //     },\n                    states: {\n                        prompt: {\n                            entry: send(({\n                                type: \"SPEAK\",\n                                value:\"I suppose you said something strange\" })),\n                             on: { ENDSPEECH: '#root.dm1.start_pos.quest.help'}\n                            }\n                        }\n            },\n            // ...\n            to_do: {\n            },\n            // ...\n            ideas: {}\n\n\n\n }})\n"]},"metadata":{},"sourceType":"module"}